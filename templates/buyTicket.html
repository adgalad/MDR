{% extends "base.html" %}


{% block content %}
    <a href="{% url 'raffleDetails' raffle.id %}"><button> < Back</button></a><br><br>
    {% for message in messages %}
        <div style="color:red"> {{ message }} </div>
    {% endfor %}
    <br>
    Ticket price: {{ raffle.ticketPrice }} Dash 
    <br><br>
    How many tickets do you want to buy?<br>
    <input id="numberTickets" type="number" value="1" onchange="requestQR()">
    <br><br>
    <a id="link" href="">
        <img id="image" href="#">
    </a>
    <p id="address"></p>

{% endblock content %}
    
{% block scripts %}
    {{ block.super }}
    <script type="text/javascript">

        const price = {{ raffle.ticketPrice }}
        const address = "{{address}}"

        function requestQR(){
            var n = parseInt(document.getElementById("numberTickets").value)
            console.log(address)
            var dashuri = "dash:" + address + "?amount=" + String(n*price) + "&label=Payment"
            document.getElementById("image").src = "https://api.qrserver.com/v1/create-qr-code/?size=150x150&data="+dashuri
            document.getElementById("link").href = dashuri
            document.getElementById("address").innerHTML = 'Or send ' +String(n*price) + ' Dash to {{address}}'
        }

        requestQR()
    </script>
{% endblock scripts %}

